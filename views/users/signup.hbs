<div class="min-h-screen bg-white flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-md w-full space-y-3">
    <!-- Mob N Access Heading -->
    <h1 class="text-center ms-9 mt-5 font-extrabold text-2xl text-indigo-600 tracking-tight">
      Mob N Access
    </h1>

    <!-- Sign-up Section -->
    <div class="bg-gray-200 py-8 px-4 shadow sm:rounded-lg sm:px-10">
      <h2 class="text-center ms-5 text-2xl font-bold leading-9 tracking-tight text-black">
        Create your account
      </h2>

      <!-- Sign-up Form -->
      <form class="space-y-6 mt-6" onsubmit="signup(event)">
        <!-- Full Name Input -->
        <div>
          <label for="name" class="block text-sm font-medium leading-6 text-gray-900">
            Full Name
          </label>
          <div class="mt-2">
            <input id="name" name="name" type="text"  class="block w-full pl-2 rounded-md border-gray-300 py-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          </div>
        </div>
        <div class="mt-2 text-sm text-red-600 bg-red-100 p-2 rounded-md hidden" id="nameError"></div>

        <!-- Email Input -->
        <div>
          <label for="email" class="block text-sm font-medium leading-6 text-gray-900">
            Email address
          </label>
          <div class="mt-2">
            <input id="email" name="email" type="text" class="block w-full pl-2 rounded-md border-gray-300 py-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          </div>
        </div>
        <div class="mt-2 text-sm text-red-600 bg-red-100 p-2 rounded-md hidden" id="emailError"></div>

        <!-- Password Input -->
        <div>
          <label for="password" class="block text-sm font-medium leading-6 text-gray-900">
            Password
          </label>
          <div class="mt-2">
            <input id="password" name="password" type="password" class="block w-full pl-2 rounded-md border-gray-300 py-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          </div>
        </div>
        <div class="mt-2 text-sm text-red-600 bg-red-100 p-2 rounded-md hidden" id="passwordError"></div>

        <!-- Confirm Password Input -->
        <div>
          <label for="confirmPassword" class="block text-sm font-medium leading-6 text-gray-900">
            Confirm Password
          </label>
          <div class="mt-2">
            <input id="confirmPassword" name="confirmPassword" type="password" class="block w-full pl-2 rounded-md border-gray-300 py-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          </div>
        </div>
        <div class="mt-2 text-sm text-red-600 bg-red-100 p-2 rounded-md hidden" id="confirmPasswordError"></div>

        <!-- Referral Code Input -->
<div>
  <label for="referralCode" class="block text-sm font-medium leading-6 text-gray-900">
    Referral Code (Optional)
  </label>
  <div class="mt-2">
    <input id="referalCode" name="referalCode" type="text" class="block w-full pl-2 rounded-md border-gray-300 py-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
  </div>
</div>
<div class="mt-2 text-sm text-red-600 bg-red-100 p-2 rounded-md hidden" id="referralCodeError"></div>


        <!-- Sign-up Button -->
        <div>
          <button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Sign up
          </button>
        </div>
      </form>

      <!-- Divider for Social Authentication -->
      <div class="relative mt-6">
        <div class="absolute inset-0 flex items-center">
          <div class="w-full border-t border-gray-300"></div>
        </div>
        <div class="relative flex justify-center text-sm">
          <span class="px-2 bg-white text-gray-500">
            Or continue with
          </span>
        </div>
      </div>

      <!-- Social Authentication Buttons -->
      <div class="mt-6 grid grid-cols-2 gap-4 ml-10">
        <button onclick="googleauthenticate()" class="ml-14 w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">
          <svg class="w-5 h-5 mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M23.5 12.3c0-.8-.1-1.6-.2-2.4H12v4.8h6.5c-.3 1.7-1.4 3.1-2.9 4.1v3.4h4.6c2.7-2.5 4.3-6.1 4.3-9.9z" fill="#4285F4"></path>
            <path d="M12 24c3.2 0 5.8-1.1 7.7-3l-4.6-3.4c-1.3.9-3 1.4-4.7 1.4-3.6 0-6.7-2.4-7.8-5.8H.7v3.5C2.5 20.6 7 24 12 24z" fill="#34A853"></path>
            <path d="M4.2 14.2C3.9 13.3 3.7 12.2 3.7 11.2s.2-2.1.5-3.1V4.6H.7C-.4 6.7-1 8.9-1 11.2s.6 4.6 1.7 6.7l3.5-3.7z" fill="#FBBC05"></path>
            <path d="M12 4.8c1.6 0 3 .6 4.1 1.7l3.1-3.1C17.8 1.4 15 0 12 0 7 0 2.5 3.4.7 8.1l3.5 3.6C5.3 6.8 8.3 4.8 12 4.8z" fill="#EA4335"></path>
          </svg>
          Google
        </button>
        {{!-- <button class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">
          <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M24 12c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 6.177 4.708 11.293 10.672 11.93v-8.422h-3.194v-3.508h3.194v-2.644c0-3.159 1.888-4.894 4.776-4.894 1.386 0 2.835.246 2.835.246v3.118h-1.596c-1.571 0-2.058 1.187-2.058 2.399v2.775h3.437l-.55 3.508h-2.887v8.422c5.964-.637 10.672-5.753 10.672-11.93z" fill="#1877F2"/>
          </svg>
          Facebook
        </button> --}}
      </div>

      <!-- Already Have Account Link -->
      <p class="mt-6 text-center text-sm text-black">
        Already have an account?
        <a href="/users/login" class="font-semibold text-indigo-600 hover:text-indigo-500">
          Sign in
        </a>
      </p>
    </div>
  </div>
</div>

<script>
  function googleauthenticate(){
   window.location.href='/users/auth/google';
  }

  function signup(e) {
  e.preventDefault();
  let isValid = true;

  const name = document.getElementById('name').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  const confirmPassword = document.getElementById('confirmPassword').value.trim();
  const referalCode=document.getElementById('referalCode').value.trim()

  // Name validation
  if(!name){
    isValid = false;
    showError('nameError',"This Field is required ! Enter the name")
  }else{
  if (!/^[a-zA-Z\s]+$/.test(name)) {
    isValid = false;
    showError('nameError', 'Name must contain only letters.');
  } else {
    hideError('nameError');
  }
  }

  // Email validation
  if(!email){
    isValid = false;
    showError('emailError',"This Field is required ! Enter the email")
  }else{
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailPattern.test(email)) {
    isValid = false;
    showError('emailError', 'Invalid email format.');
  } else {
    hideError('emailError');
  }
  }

  // Password validation
  if(!password){
    isValid = false;
    showError('passwordError',"This Field is required ! Enter the password")
  }else{
    if (password.length < 6 || !/[A-Z]/.test(password) || !/[0-9]/ || !/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
    isValid = false;
    showError('passwordError', 'Password must be at least 6 characters long, with at least one uppercase letter and one number and one special character');
  } else {
    hideError('passwordError');
  }
  }

  // Confirm password validation
  if(!confirmPassword){
    isValid = false;
    showError('confirmPasswordError',"This Field is required ! Enter the confirm password")
  }else{
    if (password !== confirmPassword) {
    isValid = false;
    showError('confirmPasswordError', 'Password and Confirm Password do not match.');
  } else {
    hideError('confirmPasswordError');
  }
  }

  if (isValid) {
    fetch('/users/signup',{
      method:"POST",
      headers: {
      "Content-Type": "application/json"
      },
      body:JSON.stringify({
        name:name,
        email:email,
        password:password,
        confirmPassword:confirmPassword,
        referalCode:referalCode
      })
    }).then((response)=>response.json()).then((response)=>{
      if(response.status){
        Swal.fire({
          icon: 'success',
          title: 'OTP Sent!',
          text:response.message,
          confirmButtonText: 'OK'
        }).then(()=>{
          location.href='/users/signupOtpVerification'
        })
      }else{
        Swal.fire({
        icon: 'error',
        title: 'Validation Error',
        text: response.message,
        confirmButtonText: 'OK'
      }).then(()=>{
        location.href='/users/signup'
      })
      }
    })
  }
}

function showError(elementId, message) {
  const errorElement = document.getElementById(elementId);
  if (errorElement) {
  errorElement.innerText = message;
  errorElement.classList.remove('hidden');
  }
}

function hideError(elementId) {
  const errorElement = document.getElementById(elementId);
   if (errorElement) {
    errorElement.innerText = '';
    errorElement.classList.add('hidden');
  } else {
    console.error(`Error: Element with ID '${elementId}' not found.`);
  }
}

</script>
